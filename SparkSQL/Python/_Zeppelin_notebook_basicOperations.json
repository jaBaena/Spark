{"paragraphs":[{"text":"%spark.conf\n\n# It is strongly recommended to set SPARK_HOME explictly instead of using the embedded spark of Zeppelin. As the function of embedded spark of Zeppelin is limited and can only run in local mode.\n# SPARK_HOME /Users/jzhang/Java/lib/spark-2.3.0-bin-hadoop2.7\n\n# Uncomment the following line if you want to use yarn-cluster mode (It is recommended to use yarn-cluster mode from Zeppelin 0.8, as the driver will run on the remote host of yarn cluster which can mitigate memory pressure of zeppelin server)\n# master yarn-cluster\n\n# Uncomment the following line if you want to use yarn-client mode (It is not recommended to use after 0.8. Because it would launch the driver in the same host of zeppelin server which will increase memory pressure of zeppelin server)\n# master yarn-client\n\n# Uncomment the following line to enable HiveContext, and also put hive-site.xml under SPARK_CONF_DIR\n# zeppelin.spark.useHiveContext true\n\n# Uncomment the following to enable IPython, PySpark will also check IPython automatically and enable it if existed.\n# zeppelin.spark.pyspark.useIPython true","user":"anonymous","dateUpdated":"2019-02-25T14:18:45+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551098345067_-290492437","id":"20190225-133905_1353729998","dateCreated":"2019-02-25T13:39:05+0100","dateStarted":"2019-02-25T14:18:45+0100","dateFinished":"2019-02-25T14:18:45+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:4644"},{"text":"%spark.pyspark\nfrom pyspark.sql import SparkSession\nfrom pyspark.sql import functions","user":"anonymous","dateUpdated":"2019-02-25T14:18:45+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1551099488347_-2109880121","id":"20190225-135808_1572421886","dateCreated":"2019-02-25T13:58:08+0100","dateStarted":"2019-02-25T14:18:45+0100","dateFinished":"2019-02-25T14:18:45+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4645"},{"text":"%spark.pyspark\n\n# We create a dataframe by reading the .csv file.\n\ndata_frame = spark.read.format(\"csv\").options(header='true', inferschema='true').load(\"data/sample.csv\").persist()","user":"anonymous","dateUpdated":"2019-02-25T14:18:45+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=30","http://192.168.211.130:4041/jobs/job?id=31"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551098626960_-14095224","id":"20190225-134346_1859274047","dateCreated":"2019-02-25T13:43:46+0100","dateStarted":"2019-02-25T14:18:45+0100","dateFinished":"2019-02-25T14:18:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4646"},{"text":"%spark.pyspark\n\n#Now let's show the dataframe and its schema.\n\ndata_frame.printSchema()\ndata_frame.show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:46+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"root\n |-- Name: string (nullable = true)\n |-- Age: integer (nullable = true)\n |-- Weight: double (nullable = true)\n |-- HasACar: boolean (nullable = true)\n |-- DateBirth: timestamp (nullable = true)\n\n+----+---+------+-------+-------------------+\n|Name|Age|Weight|HasACar|          DateBirth|\n+----+---+------+-------+-------------------+\n|Luis| 15|  58.0|   true|2010-05-03 00:00:00|\n|Lola| 25|  60.0|  false|1998-02-12 00:00:00|\n|Paco| 32|  83.2|  false|1991-01-12 00:00:00|\n+----+---+------+-------+-------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=32"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551098787962_2039971064","id":"20190225-134627_1433422320","dateCreated":"2019-02-25T13:46:27+0100","dateStarted":"2019-02-25T14:18:46+0100","dateFinished":"2019-02-25T14:18:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4647"},{"text":"%spark.pyspark\n\n# Print the data types of the data frame\n\nprint(\"data types: \" + str(data_frame.dtypes))","user":"anonymous","dateUpdated":"2019-02-25T14:18:46+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"data types: [('Name', 'string'), ('Age', 'int'), ('Weight', 'double'), ('HasACar', 'boolean'), ('DateBirth', 'timestamp')]\n"}]},"apps":[],"jobName":"paragraph_1551099104858_-548633257","id":"20190225-135144_1645737391","dateCreated":"2019-02-25T13:51:44+0100","dateStarted":"2019-02-25T14:18:46+0100","dateFinished":"2019-02-25T14:18:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4648"},{"text":"%spark.pyspark\n\n# Describe the dataframe\n    \ndata_frame\\\n    .describe()\\\n    .show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:46+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+----+----------------+------------------+\n|summary|Name|             Age|            Weight|\n+-------+----+----------------+------------------+\n|  count|   3|               3|                 3|\n|   mean|null|            24.0| 67.06666666666666|\n| stddev|null|8.54400374531753|14.007616975536322|\n|    min|Lola|              15|              58.0|\n|    max|Paco|              32|              83.2|\n+-------+----+----------------+------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=33"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099243635_2074040083","id":"20190225-135403_1916147040","dateCreated":"2019-02-25T13:54:03+0100","dateStarted":"2019-02-25T14:18:46+0100","dateFinished":"2019-02-25T14:18:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4649"},{"text":"%spark.pyspark\n\n#Select everything. We select \"name\" in this case.\n\ndata_frame.select(\"Name\").show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:47+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+\n|Name|\n+----+\n|Luis|\n|Lola|\n|Paco|\n+----+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=34"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099278352_-265670854","id":"20190225-135438_1987274426","dateCreated":"2019-02-25T13:54:38+0100","dateStarted":"2019-02-25T14:18:47+0100","dateFinished":"2019-02-25T14:18:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4650"},{"text":"%spark.pyspark\n\n# Select columns name and age, but adding 1 to age\n\ndata_frame.select(\"name\", data_frame[\"Age\"] + 1).show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:47+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---------+\n|name|(Age + 1)|\n+----+---------+\n|Luis|       16|\n|Lola|       26|\n|Paco|       33|\n+----+---------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=35"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099325258_-44615117","id":"20190225-135525_678897462","dateCreated":"2019-02-25T13:55:25+0100","dateStarted":"2019-02-25T14:18:47+0100","dateFinished":"2019-02-25T14:18:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4651"},{"text":"%spark.pyspark\n\n# Select the rows having a name length > 4\n\ndata_frame.select(functions.length(data_frame[\"Name\"]) > 4).show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:47+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+\n|(length(Name) > 4)|\n+------------------+\n|             false|\n|             false|\n|             false|\n+------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=36"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099363442_1860887563","id":"20190225-135603_655835007","dateCreated":"2019-02-25T13:56:03+0100","dateStarted":"2019-02-25T14:18:47+0100","dateFinished":"2019-02-25T14:18:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4652"},{"text":"%spark.pyspark\n\n# Select names staring with L\n\ndata_frame.select(\"name\", data_frame[\"name\"].startswith(\"L\")).show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:47+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+-------------------+\n|name|startswith(name, L)|\n+----+-------------------+\n|Luis|               true|\n|Lola|               true|\n|Paco|              false|\n+----+-------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=37"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099425123_-415222103","id":"20190225-135705_435865433","dateCreated":"2019-02-25T13:57:05+0100","dateStarted":"2019-02-25T14:18:47+0100","dateFinished":"2019-02-25T14:18:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4653"},{"text":"%spark.pyspark\n\n# Add a new column \"Senior\" containing true if the person age is > 45\n\ndata_frame.withColumn(\"Senior\", data_frame[\"Age\"] > 45).show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:47+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---+------+-------+-------------------+------+\n|Name|Age|Weight|HasACar|          DateBirth|Senior|\n+----+---+------+-------+-------------------+------+\n|Luis| 15|  58.0|   true|2010-05-03 00:00:00| false|\n|Lola| 25|  60.0|  false|1998-02-12 00:00:00| false|\n|Paco| 32|  83.2|  false|1991-01-12 00:00:00| false|\n+----+---+------+-------+-------------------+------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=38"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099731204_1449793790","id":"20190225-140211_885517932","dateCreated":"2019-02-25T14:02:11+0100","dateStarted":"2019-02-25T14:18:47+0100","dateFinished":"2019-02-25T14:18:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4654"},{"text":"%spark.pyspark\n\n# Rename column HasACar as Owner\n\ndata_frame.withColumnRenamed(\"HasACar\", \"Owner\").show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:48+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---+------+-----+-------------------+\n|Name|Age|Weight|Owner|          DateBirth|\n+----+---+------+-----+-------------------+\n|Luis| 15|  58.0| true|2010-05-03 00:00:00|\n|Lola| 25|  60.0|false|1998-02-12 00:00:00|\n|Paco| 32|  83.2|false|1991-01-12 00:00:00|\n+----+---+------+-----+-------------------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=39"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099763027_1168483125","id":"20190225-140243_1012970899","dateCreated":"2019-02-25T14:02:43+0100","dateStarted":"2019-02-25T14:18:48+0100","dateFinished":"2019-02-25T14:18:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4655"},{"text":"%spark.pyspark\n\n# Remove column DateBirth\n\ndata_frame.drop(\"DateBirth\").show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:48+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+----+---+------+-------+\n|Name|Age|Weight|HasACar|\n+----+---+------+-------+\n|Luis| 15|  58.0|   true|\n|Lola| 25|  60.0|  false|\n|Paco| 32|  83.2|  false|\n+----+---+------+-------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=40"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099783836_-1371071828","id":"20190225-140303_1448312005","dateCreated":"2019-02-25T14:03:03+0100","dateStarted":"2019-02-25T14:18:48+0100","dateFinished":"2019-02-25T14:18:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4656"},{"text":"%spark.pyspark\n\n# Get a RDD\n\nrdd_from_dataframe = data_frame\\\n    .rdd\\\n    .cache()\n\nfor i in rdd_from_dataframe.collect():\n    print(i)","user":"anonymous","dateUpdated":"2019-02-25T14:18:48+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Row(Name='Luis', Age=15, Weight=58.0, HasACar=True, DateBirth=datetime.datetime(2010, 5, 3, 0, 0))\nRow(Name='Lola', Age=25, Weight=60.0, HasACar=False, DateBirth=datetime.datetime(1998, 2, 12, 0, 0))\nRow(Name='Paco', Age=32, Weight=83.2, HasACar=False, DateBirth=datetime.datetime(1991, 1, 12, 0, 0))\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=41"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099807371_1318208897","id":"20190225-140327_994125055","dateCreated":"2019-02-25T14:03:27+0100","dateStarted":"2019-02-25T14:18:48+0100","dateFinished":"2019-02-25T14:18:48+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4657"},{"text":"%spark.pyspark\n\n# Sum all the weights (RDD)\n\nsum_of_weights = rdd_from_dataframe\\\n    .map(lambda row: row[2])\\\n    .reduce(lambda x, y: x + y)\n    \nprint(\"Sum of weights (RDDs): \" + str(sum_of_weights))","user":"anonymous","dateUpdated":"2019-02-25T14:18:48+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Sum of weights (RDDs): 201.2\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=42"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099846852_454757783","id":"20190225-140406_772332663","dateCreated":"2019-02-25T14:04:06+0100","dateStarted":"2019-02-25T14:18:48+0100","dateFinished":"2019-02-25T14:18:49+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4658"},{"text":"%spark.pyspark\n\n# Sum all the weights (dataframe)\n\ndata_frame.select(functions.sum(data_frame[\"Weight\"])).show()\n\ndata_frame.agg({\"Weight\" : \"sum\"}).show()\n\nv = data_frame.select(\"Weight\").groupBy().sum().collect()\nprint(v[0][0])","user":"anonymous","dateUpdated":"2019-02-25T14:18:49+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+\n|sum(Weight)|\n+-----------+\n|      201.2|\n+-----------+\n\n+-----------+\n|sum(Weight)|\n+-----------+\n|      201.2|\n+-----------+\n\n201.2\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=43","http://192.168.211.130:4041/jobs/job?id=44","http://192.168.211.130:4041/jobs/job?id=45"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099889699_2071912898","id":"20190225-140449_1122419162","dateCreated":"2019-02-25T14:04:49+0100","dateStarted":"2019-02-25T14:18:49+0100","dateFinished":"2019-02-25T14:18:49+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4659"},{"text":"%spark.pyspark\n\n# Get the mean age (RDD)\n\nmean_age = rdd_from_dataframe\\\n    .map(lambda row: row[1])\\\n    .reduce(lambda x, y: x + y) / rdd_from_dataframe.count()\n    \nprint(\"Mean age (RDDs): \" + str(mean_age))","user":"anonymous","dateUpdated":"2019-02-25T14:18:49+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Mean age (RDDs): 24.0\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=46","http://192.168.211.130:4041/jobs/job?id=47"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1551099944100_91834082","id":"20190225-140544_112836479","dateCreated":"2019-02-25T14:05:44+0100","dateStarted":"2019-02-25T14:18:49+0100","dateFinished":"2019-02-25T14:18:49+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4660"},{"text":"%spark.pyspark\n\n# Get the mean age (dataframe)\n\ndata_frame.select(functions.avg(data_frame[\"Age\"])).show()\ndata_frame.agg({\"Age\" : \"avg\"}).show()","user":"anonymous","dateUpdated":"2019-02-25T14:18:49+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551100012178_369638074","id":"20190225-140652_1928956825","dateCreated":"2019-02-25T14:06:52+0100","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:4661","dateFinished":"2019-02-25T14:18:50+0100","dateStarted":"2019-02-25T14:18:49+0100","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+\n|avg(Age)|\n+--------+\n|    24.0|\n+--------+\n\n+--------+\n|avg(Age)|\n+--------+\n|    24.0|\n+--------+\n\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=48","http://192.168.211.130:4041/jobs/job?id=49"],"interpreterSettingId":"spark"}}},{"text":"%spark.pyspark\n    \n# Write to a json file\n\ndata_frame\\\n    .write\\\n    .save(\"output.json\", format=\"json\")","user":"anonymous","dateUpdated":"2019-02-25T14:18:50+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551100127515_127077218","id":"20190225-140847_1251452830","dateCreated":"2019-02-25T14:08:47+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6449","dateFinished":"2019-02-25T14:18:50+0100","dateStarted":"2019-02-25T14:18:50+0100","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=50"],"interpreterSettingId":"spark"}}},{"text":"%spark.pyspark\n\n# Write to a CSV file\n\ndata_frame\\\n    .write\\\n    .format(\"csv\")\\\n    .save(\"output.csv\")","user":"anonymous","dateUpdated":"2019-02-25T14:18:50+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551100186316_-678165383","id":"20190225-140946_21048880","dateCreated":"2019-02-25T14:09:46+0100","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:6573","dateFinished":"2019-02-25T14:18:50+0100","dateStarted":"2019-02-25T14:18:50+0100","results":{"code":"SUCCESS","msg":[]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.211.130:4041/jobs/job?id=51"],"interpreterSettingId":"spark"}}},{"text":"%spark.pyspark\n","user":"anonymous","dateUpdated":"2019-02-25T14:18:50+0100","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"python","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1551100730341_1903790160","id":"20190225-141850_1564344517","dateCreated":"2019-02-25T14:18:50+0100","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:7801"}],"name":"/Zeppelin_notebook/basicOperations","id":"2E4PUKB1P","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}